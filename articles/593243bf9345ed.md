---
title: 'Deep Learningè³‡æ ¼è©¦é¨“ æ·±å±¤å­¦ç¿’ é †ä¼æ’­ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯'
emoji: 'ğŸ˜Š'
type: 'tech' # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ['Eè³‡æ ¼']
published: false
---

# ã¯ã˜ã‚ã«

æ—¥æœ¬ãƒ‡ã‚£ãƒ¼ãƒ—ãƒ©ãƒ¼ãƒ‹ãƒ³ã‚°å”ä¼šã® Deep Learning è³‡æ ¼è©¦é¨“ï¼ˆE è³‡æ ¼ï¼‰ã®å—é¨“ã«å‘ã‘ã¦ã€èª¿ã¹ãŸå†…å®¹ã‚’ã¾ã¨ã‚ã¦ã„ãã¾ã™ã€‚

# ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯å…¨ä½“åƒ

## å…¥åŠ›å±¤

## ä¸­é–“å±¤ï¼ˆéš ã‚Œå±¤ï¼‰

## å‡ºåŠ›å±¤

# æ´»æ€§åŒ–é–¢æ•°

## ã‚·ã‚°ãƒ¢ã‚¤ãƒ‰é–¢æ•°

- 0 ï½ 1 ã®é–“ã‚’ç·©ã‚„ã‹ã«å¤‰åŒ–ã™ã‚‹é–¢æ•°ã§ã‚ã‚‹ã€‚
- èª²é¡Œã¨ã—ã¦ã€å¤§ããªå€¤ã§ã¯å‡ºåŠ›ã®å¤‰åŒ–ãŒå¾®å°ãªãŸã‚ã€å‹¾é…æ¶ˆå¤±å•é¡Œã‚’å¼•ãèµ·ã“ã™äº‹ãŒã‚ã‚‹ã€‚
- å¾®åˆ†ã™ã‚‹ã¨æœ€å¤§å€¤ã¯ 0.25 ã§ã‚ã‚‹ã€‚ï¼ˆ$x=0$ã®å ´åˆï¼‰

$$
h(x) = \frac {1}{1+e^{-1}}
$$

- å¾®åˆ†ã™ã‚‹ã¨ä¸‹è¨˜ã®è¨ˆç®—ã¨ãªã‚‹ã€‚

$$
 f'(x) = f(x)(1-f(x))
$$

[ã‚¼ãƒ­ã‹ã‚‰ä½œã‚‹ Deep Learning](https://www.oreilly.co.jp/books/9784873117584/)ã‹ã‚‰å¼•ç”¨

```python:python
# ã‚·ã‚°ãƒ¢ã‚¤ãƒ‰é–¢æ•°
def sigmoid(x):
    return 1 / (1 + np.exp(-x))

# ã‚·ã‚°ãƒ¢ã‚¤ãƒ‰é–¢æ•°ã®å°é–¢æ•°
def sigmoid_grad(x):
    return (1.0 - sigmoid(x)) * sigmoid(x)
```

## ReLU é–¢æ•°

- å…¥åŠ›ãŒï¼ã‚’è¶…ãˆã¦ã„ã‚Œã°ã€ãã®å…¥åŠ›ã‚’ãã®ã¾ã¾å‡ºåŠ›ã—ã€ï¼ä»¥ä¸‹ãªã‚‰ã°ï¼ã‚’å‡ºåŠ›ã™ã‚‹é–¢æ•°ã§ã‚ã‚‹ã€‚
- å‹¾é…æ¶ˆå¤±å•é¡Œã®å›é¿ã¨ã‚¹ãƒ‘ãƒ¼ã‚¹åŒ–ã«è²¢çŒ®ã™ã‚‹ã“ã¨ã§è‰¯ã„æˆæœã‚’ã‚‚ãŸã‚‰ã—ã¦ã„ã‚‹ã€‚

$$
\begin{aligned}
    f(x) =
    \begin{cases}
        0 \quad (x \leqq 0) \\
        x \quad (x > 0) \\
    \end{cases}
\end{aligned}
$$

- å¾®åˆ†ã™ã‚‹ã¨ä¸‹è¨˜ã®çµæœã¨ãªã‚‹ã€‚

$$
\begin{aligned}
    f(x) =
    \begin{cases}
        0 \quad (x \leqq 0) \\
        1 \quad (x > 0) \\
    \end{cases}
\end{aligned}
$$

[ã‚¼ãƒ­ã‹ã‚‰ä½œã‚‹ Deep Learning](https://www.oreilly.co.jp/books/9784873117584/)ã‹ã‚‰å¼•ç”¨

```python:python
# ReLUé–¢æ•°
def relu(x):
    return np.maximum(0, x)

# ReLUé–¢æ•°ã®å°é–¢æ•°
def relu_grad(x):
    grad = np.zeros_like(x)
    grad[x>=0] = 1
    return grad
```

## ãƒã‚¤ãƒ‘ãƒœãƒªãƒƒã‚¯ã‚¿ãƒ³ã‚¸ã‚§ãƒ³ãƒˆï¼ˆtanhï¼‰é–¢æ•°

- -1.0 ï½ 1.0 ã®ç¯„å›²ã®æ•°å€¤ã«å¤‰æ›ã—ã¦å‡ºåŠ›ã™ã‚‹é–¢æ•°ã§ã‚ã‚‹ã€‚
- åº§æ¨™ç‚¹(0, 0)ã‚’åŸºç‚¹ï¼ˆå¤‰æ›²ç‚¹ï¼‰ã¨ã—ã¦ç‚¹å¯¾ç§°ã§ã‚ã‚‹ã€‚
- å¾®åˆ†ã™ã‚‹ã¨æœ€å¤§å€¤ã¯ 1.0 ã§ã‚ã‚‹ã€‚ï¼ˆ$x=0$ã®å ´åˆï¼‰

$$
\begin{aligned}
    f(x) = \frac{e^x-e^{-x}}{e^x+e^{-x}}
\end{aligned}
$$

- å¾®åˆ†ã™ã‚‹ã¨ä¸‹è¨˜ã®è¨ˆç®—ã¨ãªã‚‹ã€‚

$$
 f'(x) = 1-f(x)^2
$$

[ã‚¼ãƒ­ã‹ã‚‰ä½œã‚‹ Deep Learning](https://www.oreilly.co.jp/books/9784873117584/)ã‹ã‚‰å¼•ç”¨

```python:python
# tanhé–¢æ•°
def tanh(x):
    return np.tanh(x)
```

# èª¤å·®é€†ä¼æ’­æ³•

## èª¤å·®å‹¾é…ã®è¨ˆç®—

$$
\begin{aligned}
\nabla =  \frac{\partial E}{\partial w} = \left[ \frac{\partial E}{\partial w_1} \ldots \frac{\partial E}{\partial w_M}  \right] \\
\end{aligned}
$$

ã©ã†è¨ˆç®—ã™ã‚‹ã‹ï¼Ÿ

ç®—å‡ºã•ã‚ŒãŸèª¤å·®ã‚’ã€å‡ºåŠ›å±¤å´ã‹ã‚‰é †ã«å¾®åˆ†ã—ã€å‰ã®å±¤å‰ã®å±¤ã¸ã¨ä¼æ’­ã™ã‚‹ã€‚
æœ€å°é™ã®è¨ˆç®—ã§å„ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã§ã®å¾®åˆ†å€¤ã‚’è§£æçš„ã«è¨ˆç®—ã™ã‚‹æ‰‹æ³•ã€‚

è¨ˆç®—çµæœï¼ˆ=èª¤å·®ï¼‰ã‹ã‚‰å¾®åˆ†ã‚’é€†ç®—ã™ã‚‹ã“ã¨ã§ã€ä¸è¦ãªå†å¸°çš„è¨ˆç®—ã‚’é¿ã‘ã¦å¾®åˆ†ã‚’ç®—å‡ºã§ãã‚‹ã€‚

## èª¤å·®ä¼æ¬æ³•ã¯ã©ã®ã‚ˆã†ã«è¨ˆç®—ã—ã¦ã„ã‚‹

ä¸‹è¨˜ã®å®šç¾©ãŒã‚ã‚‹å ´åˆã«ã€$w^{(2)}$ã‚’æ±‚ã‚ãŸã„ã€‚
ã¤ã¾ã‚Šã€$\frac{\partial E}{\partial w_{ji}^{(2)}}$ãŒæœ€çµ‚çš„ã«æ±‚ã‚ãŸã„å€¤ã§ã‚ã‚‹ã€‚

$$
\begin{aligned}
E(y) &= \frac{1}{2} \sum_{j=1}^J (y_j - d_j)^2 = \frac{1}{2} ||y-d||^2  \\[8px]
y &= u^{(L)}  \\[8px]
u^l &= w^{(l)} z^{(l-1)} + b^{(l)}
\end{aligned}
$$

â€»$z$ã¯å‰ã®å±¤ã®å‡ºåŠ›

$\frac{\partial E}{\partial w_{ji}^{(2)}}$ã‚’å±•é–‹ã—ã¦ã„ã

$$
\begin{aligned}
\frac{\partial E}{\partial w_{ji}^{(2)}} &= \frac{\partial E}{\partial y} \frac{\partial y}{\partial u} \frac{\partial u}{\partial w_{ji}^{(2)}} \\[8px]
\frac{\partial E(y)}{\partial y} &= \frac{\partial}{\partial y} \frac{1}{2} ||y-d||^2 = y-b \\[8px]
\frac{\partial y(u)}{\partial u} &= \frac{\partial u}{\partial u} = 1 \\[8px]
\frac{\partial E}{\partial w_{ji}} &= \frac{\partial}{\partial w_{ji}}\left( w^{(l)} z^{(l-1)} + b^{(l)} \right) \\[8px]
&= \frac{\partial}{\partial w_{ji}} \left( \left[
   \left[
    \begin{array}{ccccccccc}
      w_{11}z_1 & + & \ldots & + & w_{1i}z_i & + & \ldots & + & w_{1I}z_I \\
       & & & & \vdots & & & & & \\
      w_{j1}z_1 & + & \ldots & + & w_{ji}z_i & + & \ldots & + & w_{jI}z_I \\
      & & & & \vdots & & & & & \\
      w_{J1}z_1 & + & \ldots & + & w_{Ji}z_i & + & \ldots & + & w_{JI}z_I \\
    \end{array}
   \right] +
   \left[
    \begin{array}{c}
      b_1 \\
      \vdots \\
      b_j \\
      \vdots \\
      b_J
    \end{array}
   \right]
\right] \right)
= \left[
    \begin{array}{c}
      0 \\
      \vdots \\
      z_i \\
      \vdots \\
      0
    \end{array}
\right] \\[8px]
\end{aligned}
$$

$E$ ã‚’ $w_{ji}$ã§å¾®åˆ†ã™ã‚‹ãŸã‚ã€$w$ã®è¡Œåˆ—ã®çœŸã‚“ä¸­ã®å€¤ä»¥å¤–ã¯å¾®åˆ†ã—ãŸçµæœã€ï¼ã«ãªã‚‹ã€‚

$$
\begin{aligned}
\frac{\partial E}{\partial y} \frac{\partial y}{\partial u} \frac{\partial u}{\partial w_{ji}^{(2)}} &= (y-d) \cdot  \left[
    \begin{array}{c}
      0 \\
      \vdots \\
      z_i \\
      \vdots \\
      0
    \end{array}
\right] = (y_j - d_j)z_i
\end{aligned}
$$
