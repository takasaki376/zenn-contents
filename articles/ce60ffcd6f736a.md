---
title: "Deep Learningè³‡æ ¼è©¦é¨“ æ·±å±¤å­¦ç¿’ å†å¸°çš„ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯"
emoji: "ğŸ·"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["Eè³‡æ ¼"]
published: true
---

# ã¯ã˜ã‚ã«

æ—¥æœ¬ãƒ‡ã‚£ãƒ¼ãƒ—ãƒ©ãƒ¼ãƒ‹ãƒ³ã‚°å”ä¼šã® Deep Learning è³‡æ ¼è©¦é¨“ï¼ˆE è³‡æ ¼ï¼‰ã®å—é¨“ã«å‘ã‘ã¦ã€èª¿ã¹ãŸå†…å®¹ã‚’ã¾ã¨ã‚ã¦ã„ãã¾ã™ã€‚

# æ¦‚è¦

- æ™‚ç³»åˆ—ãƒ‡ãƒ¼ã‚¿ã«å¯¾å¿œå¯èƒ½ãªãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã§ã‚ã‚‹ã€‚
- æ™‚ç³»åˆ—ãƒ‡ãƒ¼ã‚¿ã¨ã¯ï¼Ÿ
  - æ™‚é–“çš„é †åºã‚’è¿½ã£ã¦ä¸€å®šé–“éš”ã”ã¨ã«è¦³å¯Ÿã•ã‚Œã€ã—ã‹ã‚‚ç›¸äº’ã«çµ±è¨ˆçš„ä¾å­˜é–¢ä¿‚ãŒèªã‚ã‚‰ã‚Œã‚‹ã‚ˆã†ãªãƒ‡ãƒ¼ã‚¿ã®ç³»åˆ—
- å…·ä½“çš„ã«ã¯ï¼Ÿ
  - éŸ³å£°ãƒ‡ãƒ¼ã‚¿
  - ãƒ†ã‚­ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿
  - å¹´åº¦ã”ã¨ã®å£²ä¸Šãƒ‡ãƒ¼ã‚¿
  - ï¼‘æ™‚é–“ã”ã¨ã®é™æ°´é‡
  - è‡ªç„¶è¨€èª
- æ•°å­¦çš„è¨˜è¿°

$$
\begin{aligned}
  u^t &= W_{(in)} x^t + Wz^{t-1} + b \\[8px]
  z^t &= f\left( W_{(in)} x^t + Wz^{t-1} + b \right) \\[8px]
  v^t &= W_{(out)} z^t + c \\[8px]
  y^t &= g \left(W_{(out)} z^t + c \right)
\end{aligned}
$$

$f$ã€$g$ï¼šæ´»æ€§åŒ–é–¢æ•° \
$u$ï¼šæ´»æ€§åŒ–é–¢æ•°ã‚’é€šã™å‰ã®å…¥åŠ› Ã— é‡ã¿ \
$z$ï¼š$u$ã‚’æ´»æ€§åŒ–é–¢æ•°ã‚’é€šã—ãŸå¾Œã®å€¤ \
$v$ï¼šæ´»æ€§åŒ–é–¢æ•°ã‚’é€šã™å‰ã® zÃ— é‡ã¿ \
$y$ï¼š$v$ã‚’æ´»æ€§åŒ–é–¢æ•°ã‚’é€šã—ãŸå¾Œã®å€¤

# BPTT (Backpropagation Through Time)

- BPTT ã¨ã¯ã€RNN ã«ãŠã„ã¦ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿èª¿æ•´æ–¹æ³•ã®ä¸€ç¨®ã€€ â‡’ ã€€èª¤å·®é€†ä¼æ’­ã®ä¸€ç¨®
- èª¤å·®ãŒæ™‚é–“ã‚’ã•ã‹ã®ã¼ã£ã¦é€†ä¼æ’­ã™ã‚‹

## æ•°å­¦çš„è¨˜è¿°

### é‡ã¿

$$
\begin{aligned}
  \frac{\partial E}{\partial W_{(in)}} &= \frac{\partial E}{\partial u^t}
    \left[
      \frac{\partial u^t}{\partial W_{(in)}}
    \right]^T \\[12px]
  &= \delta^t[x^t]^T \\[12px]
  \frac{\partial E}{\partial W_{(out)}} &= \frac{\partial E}{\partial v^t}
    \left[
      \frac{\partial v^t}{\partial W_{(out)}}
    \right]^T \\[12px]
  &= \delta^{out, t}[z^t]^T \\[12px]
  \frac{\partial E}{\partial W} &= \frac{\partial E}{\partial u^t}
    \left[
      \frac{\partial u^t}{\partial W}
    \right]^T \\[12px]
  &= \delta^t[z^{t-1}]^T \\[12px]
\end{aligned}
$$

### ãƒã‚¤ã‚¢ã‚¹

$$
\begin{aligned}
  \frac{\partial E}{\partial b} &= \frac{\partial E}{\partial u^t}
  \frac{\partial u^t}{\partial b} \\[12px]
  &= \delta^t \\[12px]
  \frac{\partial E}{\partial c} &= \frac{\partial E}{\partial v^t}
  \frac{\partial v^t}{\partial c} \\[12px]
   &= \delta^{out, t}
\end{aligned}
$$

### ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æ›´æ–°

#### é‡ã¿

$$
\begin{aligned}
  W_{(in)}^{t+1} &= W_{(in)}^t-\epsilon\frac{\partial E}{\partial W_{(in)}} \\[12px]
  &= W_{(in)}^t-\epsilon\sum_{z=0}^{T_t}{\delta^{t-z}[x^{t-z}]^T} \\[12px]
  W_{(out)}^{t+1} &= W_{(out)}^t-\epsilon\frac{\partial E}{\partial W_{(out)}} \\[12px]
  &= W_{(out)}^t-\epsilon \delta^{out,t}[x^{t}]^T \\[12px]
  W^{t+1} &= W^t-\epsilon\frac{\partial E}{\partial W} \\[12px]
  &= W^t-\epsilon\sum_{z=0}^{T_t}{\delta^{t-z}[x^{t-z-1}]^T} \\[12px]
\end{aligned}
$$

#### ãƒã‚¤ã‚¢ã‚¹

$$
\begin{aligned}
  b^{t+1} &= b^t-\epsilon\frac{\partial E}{\partial b} \\[12px]
  &= b^t-\epsilon\sum_{z=0}^{T_t}{\delta^{t-z}} \\[12px]
  c^{t+1} &= c^t-\epsilon\frac{\partial E}{\partial c} \\[12px]
  &= c^t-\epsilon \delta^{out,t}
\end{aligned}
$$

# åˆ¶åº¦æŒ‡æ¨™

## BLEU

æ©Ÿæ¢°ç¿»è¨³ã®ç²¾åº¦ã‚’ç®—å‡ºã™ã‚‹éš›ã€è‹±æ–‡ã§ã¯$n=1 \sim 4$ã«ãŠã‘ã‚‹ã€modified n-gram precision ã®å€¤ã®å¯¾æ•°åŠ é‡å¹³å‡ã¨ BP ã‚’ç”¨ã„ã‚‹ã€‚å…·ä½“çš„ã«ã¯ä»¥ä¸‹ã®å¼ã‚’ç”¨ã„ã¦ç®—å‡ºã™ã‚‹ã€‚

$$
BLEU = BP \cdot exp \left( \sum_{n=1}^N \frac{1}{N} logP_n \right)
$$

åŠ é‡å¹³å‡ã§ãªãã€å¯¾æ•°åŠ é‡å¹³å‡ã‚’ç”¨ã„ã‚‹ãƒ¡ãƒªãƒƒãƒˆã¨ã—ã¦ã€æ©Ÿæ¢°ç¿»è¨³ã®å¦¥å½“æ€§ã¨æµæš¢æ€§ã‚’è€ƒæ…®ã—ãŸå®‰å®šçš„ãªè©•ä¾¡ãŒã§ãã‚‹ã€‚
modified n-gram precision ã¯ n ã«ã¤ã„ã¦æŒ‡æ•°çš„ã«å°ã•ããªã‚‹å‚¾å‘ãŒã‚ã‚‹ã€‚ãã®ãŸã‚ã€å¯¾æ•°åŠ é‡å¹³å‡ã‚’ã¨ã£ã¦ã‚¹ã‚³ã‚¢ã‚’å¹³å¦åŒ–ã—ã¦ã„ã‚‹ã€‚n ãŒå°ã•ã„æ™‚ã®ã‚¹ã‚³ã‚¢ã¯å¦¥å½“æ€§ã€n ãŒå¤§ãã„æ™‚ã®ã‚¹ã‚³ã‚¢ã¯æµæš¢æ€§ã‚’è©•ä¾¡ã—ã¦ã„ã‚‹ã¨è€ƒãˆã‚‹ã“ã¨ãŒã§ãã‚‹ã€‚

### Modified precision

å…¨ææ¡ˆè¨³æ–‡ã®å…¨ n-gram ã«ã¤ã„ã¦ã€$Count$ã¨$Count_{dp}$ã®åˆè¨ˆã®æ¯” \
ã€€ â‡’ å…¨ n-gram ã®ã†ã¡ã€ã©ã‚Œãã‚‰ã„å‚ç…§ç¿»è¨³ã®ä¸­ã«ã‚ã‚‹ï¼Ÿ

$$
\begin{aligned}
P_n = \frac{\sum_{C\in E} \sum_{n-gram \in C} Count_{dp}(n-gram)}{\sum \sum Count(n-gram)}
\end{aligned}
$$

### Brevity penaltyï¼ˆBPï¼‰

æ©Ÿæ¢°ç¿»è¨³ã¨å‚ç…§ç¿»è¨³ã®é•·ã•ã‚’è€ƒæ…®ã™ã‚‹

$$
\begin{aligned}
BP = e^{min(0 , 1-\frac{r}{c})}
\end{aligned}
$$

cï¼šææ¡ˆè¨³æ–‡ã®é•·ã• \
rï¼šRef ã®æ–‡ã®é•·ã•

$$
\begin{aligned}
    BP =
    \begin{cases}
        1  &(c \geq r) \\
        e^{1-\frac{r}{c}} &(c<e) \\
    \end{cases}
\end{aligned}
$$

# è‡ªç„¶è¨€èªå‡¦ç†

## Word2vec

- RNN ã®èª²é¡Œ:å˜èªã®ã‚ˆã†ãªå¯å¤‰é•·ã®æ–‡å­—åˆ—ã‚’ NN ã«ä¸ãˆã‚‹ã“ã¨ã¯ã§ããªã„ã€‚
  - å›ºå®šé•·å½¢å¼ã§å˜èªã‚’è¡¨ã™å¿…è¦ãŒã‚ã‚‹ã€‚
  - å…¨ã¦ã®è¨€èªã‚’è¡¨ç¾ã—ã‚ˆã†ã¨ã™ã‚‹ã¨æ¬¡å…ƒæ•°ãŒè†¨å¤§ã«ãªã‚Šã€è¨ˆç®—é‡ãŒå¢—ãˆã‚‹ã€‚ï¼ˆOne-hot ãƒ™ã‚¯ãƒˆãƒ«è¡¨ç¾ã¨ãã®é™ç•Œï¼‰
- å­¦ç¿’ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰ãƒœã‚­ãƒ£ãƒ–ãƒ©ãƒªã‚’ä½œæˆã™ã‚‹ã€‚
- å˜èªã‚’ãƒ™ã‚¯ãƒˆãƒ«åŒ–ã—ã€ä¼¼ãŸæ¦‚å¿µåŒå£«ã§ã¯ã€ä¼¼ãŸãƒ™ã‚¯ãƒˆãƒ«ã¨ã™ã‚‹ã€‚(**å˜èªåˆ†æ•£è¡¨ç¾**)
  - **ãƒ™ã‚¯ãƒˆãƒ«ã®å†…ç©**ã¯é¡ä¼¼åº¦ã‚’è¡¨ã™ã€‚
    - ï¼’ã¤ã®ãƒ™ã‚¯ãƒˆãƒ«ãŒåŒã˜å‘ãï¼šå†…ç©**å¤§**
    - ï¼’ã¤ã®ãƒ™ã‚¯ãƒˆãƒ«ãŒé–¢ä¿‚ãªã„å‘ãï¼š0
    - ï¼’ã¤ã®ãƒ™ã‚¯ãƒˆãƒ«ãŒé€†ã®å‘ãï¼šå†…ç©**ãƒã‚¤ãƒŠã‚¹ã®å¤§**
- ãƒ¡ãƒªãƒƒãƒˆ
  - å¤§è¦æ¨¡ãƒ‡ãƒ¼ã‚¿ã®åˆ†æ•£è¡¨ç¾ã®å­¦ç¿’ãŒã€ç¾å®Ÿçš„ãªè¨ˆç®—é€Ÿåº¦ã¨ãƒ¡ãƒ¢ãƒªé‡ã§å®Ÿç¾å¯èƒ½ã«ã—ãŸã€‚

## ãƒ¢ãƒ‡ãƒ«

### CBOW (Continuous Bag-of-Words Model)

- å…¥åŠ›ã¨ã—ã¦å‘¨è¾ºã®å˜èªã‚’ä¸ãˆã€ä¸­å¿ƒèªã‚’äºˆæ¸¬ã™ã‚‹ã€‚

### Skip-Gramï¼ˆContinuous Skip-Gram Modelï¼‰

- å…¥åŠ›ã¨ã—ã¦ä¸­å¿ƒèªã‚’ä¸ãˆã€ãã®å‘¨è¾ºèªã®äºˆæ¸¬ã™ã‚‹ã€‚

## è² ä¾‹ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°

- æå¤±é–¢æ•°ã®è¨ˆç®—æ™‚é–“ã®çŸ­ç¸®ã‚’å›³ã‚‹ã€‚
- **CBOW** ã¨ **Skip-Gram** ã«ãŠã‘ã‚‹å‡ºåŠ›å±¤ã§ã¯ã€å…¨ã¦ã®èªå½™ã‚’å¯¾è±¡ã¨ã—ã¦ã€ã‚½ãƒ•ãƒˆãƒãƒƒã‚¯ã‚¹é–¢æ•°ã¨äº¤å·®ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼èª¤å·®é–¢æ•°ã®è¨ˆç®—ã‚’è¡Œã†ã€‚
- **è² ä¾‹ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°**ã‚’é©ç”¨ã—ãŸå ´åˆã®å‡ºåŠ›å±¤ã§ã¯ã€ï¼‘å€‹ã®æ­£ä¾‹ã¨$k$å€‹ã®è² ä¾‹ã ã‘ã‚’å¯¾è±¡ã¨ã—ã¦ã‚·ã‚°ãƒ¢ã‚¤ãƒ‰é–¢æ•°ã¨äº¤å·®ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼èª¤å·®é–¢æ•°ã®è¨ˆç®—ã‚’è¡Œã†ã€‚
- **CBOW** ã¨ **Skip-Gram** ã«ãŠã‘ã‚‹å‡ºåŠ›å±¤ã§ã¯ã€å¤šã‚¯ãƒ©ã‚¹åˆ†é¡å•é¡Œã‚’è§£ã„ã¦ã„ã‚‹ãŒã€**è² ä¾‹ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°**ã‚’é©ç”¨ã—ãŸå ´åˆã¯$k+1$å€‹ã®ï¼’ã‚¯ãƒ©ã‚¹åˆ†é¡å•é¡Œã‚’è§£ã„ã¦ã„ã‚‹ã€‚
- $k$å€‹ã®è² ä¾‹ã¯ã€ã‚³ãƒ¼ãƒ‘ã‚¹ã®ä¸­ã‹ã‚‰å˜èªã®å‡ºç¾é »åº¦ã«åŸºã¥ã„ã¦ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°ã™ã‚‹ã€‚
